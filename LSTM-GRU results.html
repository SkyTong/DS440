<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>d651fe364f4842cbb87178e03e48673f</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" data-execution_count="261" id="CB5mFIAXHD-v"
data-scrolled="true">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dateutil <span class="im">import</span> parser</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.dates <span class="im">as</span> mdates</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.ticker <span class="im">as</span> plticker</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> LSTM, GRU</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">#np.set_printoptions(threshold=np.inf)</span></span></code></pre></div>
</div>
<section id="load-the-dataset" class="cell markdown" id="4LD1AHsUHD-z">
<h1>Load the dataset</h1>
</section>
<div class="cell code" data-execution_count="262" id="mtRYCV-DHD-0">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>org_df <span class="op">=</span> pd.read_csv(<span class="st">&#39;/content/processed_daily_data.csv&#39;</span>,index_col<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="263"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:635}"
id="cwctL151HD-1" data-outputId="632cb058-14c4-4883-9f78-3fb1d2af3327"
data-scrolled="false">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>org_df</span></code></pre></div>
<div class="output execute_result" data-execution_count="263">

  <div id="df-b5316096-aff6-46ed-8725-570a222d534f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Date</th>
      <th>SP500</th>
      <th>DOW30</th>
      <th>EuroStoxx50</th>
      <th>NASDAQ</th>
      <th>CrudeOil</th>
      <th>SSE</th>
      <th>Gold</th>
      <th>VIX</th>
      <th>...</th>
      <th>transaction_count</th>
      <th>transaction_count_all_time</th>
      <th>large_transaction_count</th>
      <th>average_transaction_value</th>
      <th>block_height</th>
      <th>hashrate</th>
      <th>difficulty</th>
      <th>block_time</th>
      <th>block_size</th>
      <th>current_supply</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>7.0</td>
      <td>2022-02-07</td>
      <td>4483.870117</td>
      <td>35091.128906</td>
      <td>4120.560059</td>
      <td>14015.669922</td>
      <td>91.320000</td>
      <td>3429.580078</td>
      <td>1820.599976</td>
      <td>22.860001</td>
      <td>...</td>
      <td>262034</td>
      <td>708920351</td>
      <td>22948</td>
      <td>18.010471</td>
      <td>722252</td>
      <td>1.807953e+08</td>
      <td>2.669053e+13</td>
      <td>634.059259</td>
      <td>1220094</td>
      <td>18951581</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8.0</td>
      <td>2022-02-08</td>
      <td>4521.540039</td>
      <td>35462.781250</td>
      <td>4129.250000</td>
      <td>14194.450195</td>
      <td>89.360001</td>
      <td>3452.629883</td>
      <td>1826.599976</td>
      <td>21.440001</td>
      <td>...</td>
      <td>276850</td>
      <td>709197201</td>
      <td>23752</td>
      <td>43.189954</td>
      <td>722406</td>
      <td>2.046145e+08</td>
      <td>2.669053e+13</td>
      <td>560.248366</td>
      <td>1269141</td>
      <td>18952606</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9.0</td>
      <td>2022-02-09</td>
      <td>4587.180176</td>
      <td>35768.058594</td>
      <td>4204.089844</td>
      <td>14490.370117</td>
      <td>89.660004</td>
      <td>3479.949951</td>
      <td>1835.199951</td>
      <td>19.959999</td>
      <td>...</td>
      <td>265804</td>
      <td>709463005</td>
      <td>21082</td>
      <td>20.272357</td>
      <td>722546</td>
      <td>1.854157e+08</td>
      <td>2.669053e+13</td>
      <td>618.258993</td>
      <td>1412872</td>
      <td>18953425</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10.0</td>
      <td>2022-02-10</td>
      <td>4504.080078</td>
      <td>35241.589844</td>
      <td>4197.069824</td>
      <td>14185.639648</td>
      <td>89.879997</td>
      <td>3485.909912</td>
      <td>1836.199951</td>
      <td>23.910000</td>
      <td>...</td>
      <td>260813</td>
      <td>709723818</td>
      <td>21476</td>
      <td>20.544074</td>
      <td>722693</td>
      <td>1.945608e+08</td>
      <td>2.669053e+13</td>
      <td>589.198630</td>
      <td>1389048</td>
      <td>18954337</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11.0</td>
      <td>2022-02-11</td>
      <td>4418.640137</td>
      <td>34738.058594</td>
      <td>4155.229980</td>
      <td>13791.150391</td>
      <td>93.099998</td>
      <td>3462.949951</td>
      <td>1840.800049</td>
      <td>27.360001</td>
      <td>...</td>
      <td>258595</td>
      <td>709982413</td>
      <td>20452</td>
      <td>15.155736</td>
      <td>722835</td>
      <td>1.912526e+08</td>
      <td>2.669053e+13</td>
      <td>599.390071</td>
      <td>1526755</td>
      <td>18955312</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>745</th>
      <td>745.0</td>
      <td>2024-02-15</td>
      <td>5029.729980</td>
      <td>38773.121094</td>
      <td>4743.169922</td>
      <td>15906.169922</td>
      <td>78.029999</td>
      <td>2865.903076</td>
      <td>2002.099976</td>
      <td>14.010000</td>
      <td>...</td>
      <td>303306</td>
      <td>965991635</td>
      <td>24170</td>
      <td>3.222092</td>
      <td>830643</td>
      <td>6.060194e+08</td>
      <td>7.756333e+13</td>
      <td>549.705128</td>
      <td>2080268</td>
      <td>19629025</td>
    </tr>
    <tr>
      <th>746</th>
      <td>746.0</td>
      <td>2024-02-16</td>
      <td>5005.569824</td>
      <td>38627.988281</td>
      <td>4765.649902</td>
      <td>15775.650391</td>
      <td>79.190002</td>
      <td>2865.903076</td>
      <td>2011.500000</td>
      <td>14.240000</td>
      <td>...</td>
      <td>312782</td>
      <td>966304417</td>
      <td>21666</td>
      <td>2.991963</td>
      <td>830777</td>
      <td>5.467598e+08</td>
      <td>8.172530e+13</td>
      <td>641.977444</td>
      <td>1807967</td>
      <td>19629862</td>
    </tr>
    <tr>
      <th>747</th>
      <td>747.0</td>
      <td>2024-02-17</td>
      <td>5005.569824</td>
      <td>38627.988281</td>
      <td>4765.649902</td>
      <td>15775.650391</td>
      <td>79.190002</td>
      <td>2865.903076</td>
      <td>2011.500000</td>
      <td>14.240000</td>
      <td>...</td>
      <td>327713</td>
      <td>966632130</td>
      <td>16967</td>
      <td>1.708139</td>
      <td>830927</td>
      <td>6.086717e+08</td>
      <td>8.172530e+13</td>
      <td>576.677852</td>
      <td>1848949</td>
      <td>19630800</td>
    </tr>
    <tr>
      <th>748</th>
      <td>748.0</td>
      <td>2024-02-18</td>
      <td>5005.569824</td>
      <td>38627.988281</td>
      <td>4765.649902</td>
      <td>15775.650391</td>
      <td>79.190002</td>
      <td>2865.903076</td>
      <td>2011.500000</td>
      <td>14.240000</td>
      <td>...</td>
      <td>343417</td>
      <td>966975547</td>
      <td>15213</td>
      <td>1.676919</td>
      <td>831048</td>
      <td>4.904280e+08</td>
      <td>8.172530e+13</td>
      <td>715.716667</td>
      <td>1848168</td>
      <td>19631556</td>
    </tr>
    <tr>
      <th>749</th>
      <td>749.0</td>
      <td>2024-02-19</td>
      <td>5005.569824</td>
      <td>38627.988281</td>
      <td>4763.069824</td>
      <td>15775.650391</td>
      <td>79.190002</td>
      <td>2910.543945</td>
      <td>2011.500000</td>
      <td>14.240000</td>
      <td>...</td>
      <td>366108</td>
      <td>967341655</td>
      <td>17662</td>
      <td>2.264910</td>
      <td>831184</td>
      <td>5.522588e+08</td>
      <td>8.172530e+13</td>
      <td>635.585185</td>
      <td>1692326</td>
      <td>19632406</td>
    </tr>
  </tbody>
</table>
<p>743 rows × 32 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b5316096-aff6-46ed-8725-570a222d534f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b5316096-aff6-46ed-8725-570a222d534f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b5316096-aff6-46ed-8725-570a222d534f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-fcf4ce4c-889b-4105-867b-1a840a9b355b">
  <button class="colab-df-quickchart" onclick="quickchart('df-fcf4ce4c-889b-4105-867b-1a840a9b355b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-fcf4ce4c-889b-4105-867b-1a840a9b355b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_bd168aef-a883-453f-98ea-5a76243ec32a">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('org_df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_bd168aef-a883-453f-98ea-5a76243ec32a button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('org_df');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="264"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:617}"
id="-BoNCQ4Ka77G" data-outputId="957d47c4-db20-4903-e3e9-9740177a4850">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your DataFrame is called org_df</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the first column</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>org_df <span class="op">=</span> org_df.drop(org_df.columns[<span class="dv">0</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Now org_df will have the first column removed</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>org_df</span></code></pre></div>
<div class="output execute_result" data-execution_count="264">

  <div id="df-4af8ae13-48c0-43bd-b365-0f3b11d34fc6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>SP500</th>
      <th>DOW30</th>
      <th>EuroStoxx50</th>
      <th>NASDAQ</th>
      <th>CrudeOil</th>
      <th>SSE</th>
      <th>Gold</th>
      <th>VIX</th>
      <th>Nikkei225</th>
      <th>...</th>
      <th>transaction_count</th>
      <th>transaction_count_all_time</th>
      <th>large_transaction_count</th>
      <th>average_transaction_value</th>
      <th>block_height</th>
      <th>hashrate</th>
      <th>difficulty</th>
      <th>block_time</th>
      <th>block_size</th>
      <th>current_supply</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>2022-02-07</td>
      <td>4483.870117</td>
      <td>35091.128906</td>
      <td>4120.560059</td>
      <td>14015.669922</td>
      <td>91.320000</td>
      <td>3429.580078</td>
      <td>1820.599976</td>
      <td>22.860001</td>
      <td>27248.869141</td>
      <td>...</td>
      <td>262034</td>
      <td>708920351</td>
      <td>22948</td>
      <td>18.010471</td>
      <td>722252</td>
      <td>1.807953e+08</td>
      <td>2.669053e+13</td>
      <td>634.059259</td>
      <td>1220094</td>
      <td>18951581</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2022-02-08</td>
      <td>4521.540039</td>
      <td>35462.781250</td>
      <td>4129.250000</td>
      <td>14194.450195</td>
      <td>89.360001</td>
      <td>3452.629883</td>
      <td>1826.599976</td>
      <td>21.440001</td>
      <td>27284.519531</td>
      <td>...</td>
      <td>276850</td>
      <td>709197201</td>
      <td>23752</td>
      <td>43.189954</td>
      <td>722406</td>
      <td>2.046145e+08</td>
      <td>2.669053e+13</td>
      <td>560.248366</td>
      <td>1269141</td>
      <td>18952606</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2022-02-09</td>
      <td>4587.180176</td>
      <td>35768.058594</td>
      <td>4204.089844</td>
      <td>14490.370117</td>
      <td>89.660004</td>
      <td>3479.949951</td>
      <td>1835.199951</td>
      <td>19.959999</td>
      <td>27579.869141</td>
      <td>...</td>
      <td>265804</td>
      <td>709463005</td>
      <td>21082</td>
      <td>20.272357</td>
      <td>722546</td>
      <td>1.854157e+08</td>
      <td>2.669053e+13</td>
      <td>618.258993</td>
      <td>1412872</td>
      <td>18953425</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2022-02-10</td>
      <td>4504.080078</td>
      <td>35241.589844</td>
      <td>4197.069824</td>
      <td>14185.639648</td>
      <td>89.879997</td>
      <td>3485.909912</td>
      <td>1836.199951</td>
      <td>23.910000</td>
      <td>27696.080078</td>
      <td>...</td>
      <td>260813</td>
      <td>709723818</td>
      <td>21476</td>
      <td>20.544074</td>
      <td>722693</td>
      <td>1.945608e+08</td>
      <td>2.669053e+13</td>
      <td>589.198630</td>
      <td>1389048</td>
      <td>18954337</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2022-02-11</td>
      <td>4418.640137</td>
      <td>34738.058594</td>
      <td>4155.229980</td>
      <td>13791.150391</td>
      <td>93.099998</td>
      <td>3462.949951</td>
      <td>1840.800049</td>
      <td>27.360001</td>
      <td>27696.080078</td>
      <td>...</td>
      <td>258595</td>
      <td>709982413</td>
      <td>20452</td>
      <td>15.155736</td>
      <td>722835</td>
      <td>1.912526e+08</td>
      <td>2.669053e+13</td>
      <td>599.390071</td>
      <td>1526755</td>
      <td>18955312</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>745</th>
      <td>2024-02-15</td>
      <td>5029.729980</td>
      <td>38773.121094</td>
      <td>4743.169922</td>
      <td>15906.169922</td>
      <td>78.029999</td>
      <td>2865.903076</td>
      <td>2002.099976</td>
      <td>14.010000</td>
      <td>38157.941406</td>
      <td>...</td>
      <td>303306</td>
      <td>965991635</td>
      <td>24170</td>
      <td>3.222092</td>
      <td>830643</td>
      <td>6.060194e+08</td>
      <td>7.756333e+13</td>
      <td>549.705128</td>
      <td>2080268</td>
      <td>19629025</td>
    </tr>
    <tr>
      <th>746</th>
      <td>2024-02-16</td>
      <td>5005.569824</td>
      <td>38627.988281</td>
      <td>4765.649902</td>
      <td>15775.650391</td>
      <td>79.190002</td>
      <td>2865.903076</td>
      <td>2011.500000</td>
      <td>14.240000</td>
      <td>38487.238281</td>
      <td>...</td>
      <td>312782</td>
      <td>966304417</td>
      <td>21666</td>
      <td>2.991963</td>
      <td>830777</td>
      <td>5.467598e+08</td>
      <td>8.172530e+13</td>
      <td>641.977444</td>
      <td>1807967</td>
      <td>19629862</td>
    </tr>
    <tr>
      <th>747</th>
      <td>2024-02-17</td>
      <td>5005.569824</td>
      <td>38627.988281</td>
      <td>4765.649902</td>
      <td>15775.650391</td>
      <td>79.190002</td>
      <td>2865.903076</td>
      <td>2011.500000</td>
      <td>14.240000</td>
      <td>38487.238281</td>
      <td>...</td>
      <td>327713</td>
      <td>966632130</td>
      <td>16967</td>
      <td>1.708139</td>
      <td>830927</td>
      <td>6.086717e+08</td>
      <td>8.172530e+13</td>
      <td>576.677852</td>
      <td>1848949</td>
      <td>19630800</td>
    </tr>
    <tr>
      <th>748</th>
      <td>2024-02-18</td>
      <td>5005.569824</td>
      <td>38627.988281</td>
      <td>4765.649902</td>
      <td>15775.650391</td>
      <td>79.190002</td>
      <td>2865.903076</td>
      <td>2011.500000</td>
      <td>14.240000</td>
      <td>38487.238281</td>
      <td>...</td>
      <td>343417</td>
      <td>966975547</td>
      <td>15213</td>
      <td>1.676919</td>
      <td>831048</td>
      <td>4.904280e+08</td>
      <td>8.172530e+13</td>
      <td>715.716667</td>
      <td>1848168</td>
      <td>19631556</td>
    </tr>
    <tr>
      <th>749</th>
      <td>2024-02-19</td>
      <td>5005.569824</td>
      <td>38627.988281</td>
      <td>4763.069824</td>
      <td>15775.650391</td>
      <td>79.190002</td>
      <td>2910.543945</td>
      <td>2011.500000</td>
      <td>14.240000</td>
      <td>38470.378906</td>
      <td>...</td>
      <td>366108</td>
      <td>967341655</td>
      <td>17662</td>
      <td>2.264910</td>
      <td>831184</td>
      <td>5.522588e+08</td>
      <td>8.172530e+13</td>
      <td>635.585185</td>
      <td>1692326</td>
      <td>19632406</td>
    </tr>
  </tbody>
</table>
<p>743 rows × 31 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4af8ae13-48c0-43bd-b365-0f3b11d34fc6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4af8ae13-48c0-43bd-b365-0f3b11d34fc6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4af8ae13-48c0-43bd-b365-0f3b11d34fc6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-7a724039-9474-4a58-a70f-84609d25a360">
  <button class="colab-df-quickchart" onclick="quickchart('df-7a724039-9474-4a58-a70f-84609d25a360')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-7a724039-9474-4a58-a70f-84609d25a360 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_42b4b084-e438-428e-8d3f-57b447154aaf">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('org_df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_42b4b084-e438-428e-8d3f-57b447154aaf button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('org_df');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="265"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="dAjWHICjHD-1" data-outputId="4dbe6c31-2b77-4e62-ddce-5bc238af0d0c"
data-scrolled="false">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>org_df.columns</span></code></pre></div>
<div class="output execute_result" data-execution_count="265">
<pre><code>Index([&#39;Date&#39;, &#39;SP500&#39;, &#39;DOW30&#39;, &#39;EuroStoxx50&#39;, &#39;NASDAQ&#39;, &#39;CrudeOil&#39;, &#39;SSE&#39;,
       &#39;Gold&#39;, &#39;VIX&#39;, &#39;Nikkei225&#39;, &#39;FTSE100&#39;, &#39;EURUSD&#39;, &#39;CNYUSD&#39;, &#39;GBPUSD&#39;,
       &#39;JPYUSD&#39;, &#39;CHFUSD&#39;, &#39;BTC&#39;, &#39;zero_balance_addresses_all_time&#39;,
       &#39;unique_addresses_all_time&#39;, &#39;new_addresses&#39;, &#39;active_addresses&#39;,
       &#39;transaction_count&#39;, &#39;transaction_count_all_time&#39;,
       &#39;large_transaction_count&#39;, &#39;average_transaction_value&#39;, &#39;block_height&#39;,
       &#39;hashrate&#39;, &#39;difficulty&#39;, &#39;block_time&#39;, &#39;block_size&#39;, &#39;current_supply&#39;],
      dtype=&#39;object&#39;)</code></pre>
</div>
</div>
<section id="features-engineering" class="cell markdown"
id="Tyb4X_WtHD-1">
<h1>Features engineering</h1>
</section>
<div class="cell code" data-execution_count="266"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:617}"
id="6O8yE-QPHD-2" data-outputId="51ef6855-e5cb-414c-9b2d-3a253281a1de">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>org_df</span></code></pre></div>
<div class="output execute_result" data-execution_count="266">

  <div id="df-442d482d-b479-4c78-b826-846c9828310c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>SP500</th>
      <th>DOW30</th>
      <th>EuroStoxx50</th>
      <th>NASDAQ</th>
      <th>CrudeOil</th>
      <th>SSE</th>
      <th>Gold</th>
      <th>VIX</th>
      <th>Nikkei225</th>
      <th>...</th>
      <th>transaction_count</th>
      <th>transaction_count_all_time</th>
      <th>large_transaction_count</th>
      <th>average_transaction_value</th>
      <th>block_height</th>
      <th>hashrate</th>
      <th>difficulty</th>
      <th>block_time</th>
      <th>block_size</th>
      <th>current_supply</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>2022-02-07</td>
      <td>4483.870117</td>
      <td>35091.128906</td>
      <td>4120.560059</td>
      <td>14015.669922</td>
      <td>91.320000</td>
      <td>3429.580078</td>
      <td>1820.599976</td>
      <td>22.860001</td>
      <td>27248.869141</td>
      <td>...</td>
      <td>262034</td>
      <td>708920351</td>
      <td>22948</td>
      <td>18.010471</td>
      <td>722252</td>
      <td>1.807953e+08</td>
      <td>2.669053e+13</td>
      <td>634.059259</td>
      <td>1220094</td>
      <td>18951581</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2022-02-08</td>
      <td>4521.540039</td>
      <td>35462.781250</td>
      <td>4129.250000</td>
      <td>14194.450195</td>
      <td>89.360001</td>
      <td>3452.629883</td>
      <td>1826.599976</td>
      <td>21.440001</td>
      <td>27284.519531</td>
      <td>...</td>
      <td>276850</td>
      <td>709197201</td>
      <td>23752</td>
      <td>43.189954</td>
      <td>722406</td>
      <td>2.046145e+08</td>
      <td>2.669053e+13</td>
      <td>560.248366</td>
      <td>1269141</td>
      <td>18952606</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2022-02-09</td>
      <td>4587.180176</td>
      <td>35768.058594</td>
      <td>4204.089844</td>
      <td>14490.370117</td>
      <td>89.660004</td>
      <td>3479.949951</td>
      <td>1835.199951</td>
      <td>19.959999</td>
      <td>27579.869141</td>
      <td>...</td>
      <td>265804</td>
      <td>709463005</td>
      <td>21082</td>
      <td>20.272357</td>
      <td>722546</td>
      <td>1.854157e+08</td>
      <td>2.669053e+13</td>
      <td>618.258993</td>
      <td>1412872</td>
      <td>18953425</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2022-02-10</td>
      <td>4504.080078</td>
      <td>35241.589844</td>
      <td>4197.069824</td>
      <td>14185.639648</td>
      <td>89.879997</td>
      <td>3485.909912</td>
      <td>1836.199951</td>
      <td>23.910000</td>
      <td>27696.080078</td>
      <td>...</td>
      <td>260813</td>
      <td>709723818</td>
      <td>21476</td>
      <td>20.544074</td>
      <td>722693</td>
      <td>1.945608e+08</td>
      <td>2.669053e+13</td>
      <td>589.198630</td>
      <td>1389048</td>
      <td>18954337</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2022-02-11</td>
      <td>4418.640137</td>
      <td>34738.058594</td>
      <td>4155.229980</td>
      <td>13791.150391</td>
      <td>93.099998</td>
      <td>3462.949951</td>
      <td>1840.800049</td>
      <td>27.360001</td>
      <td>27696.080078</td>
      <td>...</td>
      <td>258595</td>
      <td>709982413</td>
      <td>20452</td>
      <td>15.155736</td>
      <td>722835</td>
      <td>1.912526e+08</td>
      <td>2.669053e+13</td>
      <td>599.390071</td>
      <td>1526755</td>
      <td>18955312</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>745</th>
      <td>2024-02-15</td>
      <td>5029.729980</td>
      <td>38773.121094</td>
      <td>4743.169922</td>
      <td>15906.169922</td>
      <td>78.029999</td>
      <td>2865.903076</td>
      <td>2002.099976</td>
      <td>14.010000</td>
      <td>38157.941406</td>
      <td>...</td>
      <td>303306</td>
      <td>965991635</td>
      <td>24170</td>
      <td>3.222092</td>
      <td>830643</td>
      <td>6.060194e+08</td>
      <td>7.756333e+13</td>
      <td>549.705128</td>
      <td>2080268</td>
      <td>19629025</td>
    </tr>
    <tr>
      <th>746</th>
      <td>2024-02-16</td>
      <td>5005.569824</td>
      <td>38627.988281</td>
      <td>4765.649902</td>
      <td>15775.650391</td>
      <td>79.190002</td>
      <td>2865.903076</td>
      <td>2011.500000</td>
      <td>14.240000</td>
      <td>38487.238281</td>
      <td>...</td>
      <td>312782</td>
      <td>966304417</td>
      <td>21666</td>
      <td>2.991963</td>
      <td>830777</td>
      <td>5.467598e+08</td>
      <td>8.172530e+13</td>
      <td>641.977444</td>
      <td>1807967</td>
      <td>19629862</td>
    </tr>
    <tr>
      <th>747</th>
      <td>2024-02-17</td>
      <td>5005.569824</td>
      <td>38627.988281</td>
      <td>4765.649902</td>
      <td>15775.650391</td>
      <td>79.190002</td>
      <td>2865.903076</td>
      <td>2011.500000</td>
      <td>14.240000</td>
      <td>38487.238281</td>
      <td>...</td>
      <td>327713</td>
      <td>966632130</td>
      <td>16967</td>
      <td>1.708139</td>
      <td>830927</td>
      <td>6.086717e+08</td>
      <td>8.172530e+13</td>
      <td>576.677852</td>
      <td>1848949</td>
      <td>19630800</td>
    </tr>
    <tr>
      <th>748</th>
      <td>2024-02-18</td>
      <td>5005.569824</td>
      <td>38627.988281</td>
      <td>4765.649902</td>
      <td>15775.650391</td>
      <td>79.190002</td>
      <td>2865.903076</td>
      <td>2011.500000</td>
      <td>14.240000</td>
      <td>38487.238281</td>
      <td>...</td>
      <td>343417</td>
      <td>966975547</td>
      <td>15213</td>
      <td>1.676919</td>
      <td>831048</td>
      <td>4.904280e+08</td>
      <td>8.172530e+13</td>
      <td>715.716667</td>
      <td>1848168</td>
      <td>19631556</td>
    </tr>
    <tr>
      <th>749</th>
      <td>2024-02-19</td>
      <td>5005.569824</td>
      <td>38627.988281</td>
      <td>4763.069824</td>
      <td>15775.650391</td>
      <td>79.190002</td>
      <td>2910.543945</td>
      <td>2011.500000</td>
      <td>14.240000</td>
      <td>38470.378906</td>
      <td>...</td>
      <td>366108</td>
      <td>967341655</td>
      <td>17662</td>
      <td>2.264910</td>
      <td>831184</td>
      <td>5.522588e+08</td>
      <td>8.172530e+13</td>
      <td>635.585185</td>
      <td>1692326</td>
      <td>19632406</td>
    </tr>
  </tbody>
</table>
<p>743 rows × 31 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-442d482d-b479-4c78-b826-846c9828310c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-442d482d-b479-4c78-b826-846c9828310c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-442d482d-b479-4c78-b826-846c9828310c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-0afb9802-38f5-4dc9-92e4-a877aa482cac">
  <button class="colab-df-quickchart" onclick="quickchart('df-0afb9802-38f5-4dc9-92e4-a877aa482cac')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-0afb9802-38f5-4dc9-92e4-a877aa482cac button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_4545175a-42a8-4b2c-8e01-2307e9f1c1fe">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('org_df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_4545175a-42a8-4b2c-8e01-2307e9f1c1fe button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('org_df');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="267"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="21TDFBPZLhw1" data-outputId="171463a3-a0f7-4c6b-e9da-bc78dfe1a4ed">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your DataFrame is called org_df</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert &#39;Datetime&#39; column to datetime data type</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>org_df[<span class="st">&#39;Date&#39;</span>] <span class="op">=</span> pd.to_datetime(org_df[<span class="st">&#39;Date&#39;</span>])</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set &#39;Datetime&#39; column as the index</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>org_df.set_index(<span class="st">&#39;Date&#39;</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now &#39;Datetime&#39; column should be the index of the DataFrame</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the data type of the index</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Data type of elements in the index:&quot;</span>, org_df.index.dtype)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the data types of all columns again</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Data types of all columns:&quot;</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(org_df.dtypes)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Data type of elements in the index: datetime64[ns]

Data types of all columns:
SP500                              float64
DOW30                              float64
EuroStoxx50                        float64
NASDAQ                             float64
CrudeOil                           float64
SSE                                float64
Gold                               float64
VIX                                float64
Nikkei225                          float64
FTSE100                            float64
EURUSD                             float64
CNYUSD                             float64
GBPUSD                             float64
JPYUSD                             float64
CHFUSD                             float64
BTC                                float64
zero_balance_addresses_all_time      int64
unique_addresses_all_time            int64
new_addresses                        int64
active_addresses                     int64
transaction_count                    int64
transaction_count_all_time           int64
large_transaction_count              int64
average_transaction_value          float64
block_height                         int64
hashrate                           float64
difficulty                         float64
block_time                         float64
block_size                           int64
current_supply                       int64
dtype: object
</code></pre>
</div>
</div>
<section id="dataset-scalling" class="cell markdown" id="I5l2BHWWHD-2">
<h1>Dataset scalling</h1>
</section>
<div class="cell code" data-execution_count="268"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="2fRwHTYuHD-3" data-outputId="9e3e4b4d-b8e3-42f7-8602-c1dbec58b115"
data-scrolled="true">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> org_df.values</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> dataset.astype(<span class="st">&#39;float32&#39;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler(feature_range<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> scaler.fit_transform(dataset)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print(&#39;dataset.shape&#39;, dataset.shape)</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>num_of_features <span class="op">=</span> <span class="bu">len</span>(org_df.columns)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Number of features&#39;</span>, num_of_features)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Number of features 30
</code></pre>
</div>
</div>
<section id="configuration" class="cell markdown" id="ZRja8BK3HD-3">
<h1>Configuration</h1>
</section>
<div class="cell code" data-execution_count="269" id="NBTpFgD6HD-3">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>expr_name <span class="op">=</span> <span class="st">&#39;expr_16&#39;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>look_back <span class="op">=</span> <span class="dv">30</span> <span class="co"># 60 days, as each entry is for 1 hour</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>lstm_layers <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">10</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="dv">32</span></span></code></pre></div>
</div>
<section id="spliting-datasets-into-train-and-test"
class="cell markdown" id="w7E7YsuzHD-4">
<h1>spliting datasets into train and test</h1>
</section>
<div class="cell code" data-execution_count="270"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="_CRgs0bHHD-4" data-outputId="70222539-138c-4079-cf69-62d3801615ef">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>train_size_percent <span class="op">=</span> <span class="fl">0.80</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>pred_col <span class="op">=</span> org_df.columns.get_loc(<span class="st">&#39;BTC&#39;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># function to split the data</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_dataset(dataset, pred_col, look_back<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  dataX, dataY <span class="op">=</span> [], []</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dataset)<span class="op">-</span>look_back<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> dataset[i:(i<span class="op">+</span>look_back), :]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    dataX.append(a)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    dataY.append(dataset[i <span class="op">+</span> look_back, pred_col])</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> np.array(dataX), np.array(dataY)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>train_size <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(dataset) <span class="op">*</span> train_size_percent)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>test_size <span class="op">=</span> <span class="bu">len</span>(dataset) <span class="op">-</span> train_size</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>train, test <span class="op">=</span> dataset[<span class="dv">0</span>:train_size, :], dataset[train_size:<span class="bu">len</span>(dataset), :]</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> create_dataset(train, pred_col, look_back<span class="op">=</span>look_back)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> create_dataset(test, pred_col, look_back<span class="op">=</span>look_back)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co"># reshape input to be  [samples, time steps, features]</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>trainX <span class="op">=</span> np.reshape(trainX, (trainX.shape[<span class="dv">0</span>], look_back, num_of_features))</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>testX <span class="op">=</span> np.reshape(testX, (testX.shape[<span class="dv">0</span>],look_back, num_of_features))</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Training dataset length &#39;</span>, <span class="bu">len</span>(train))</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Testing dataset length &#39;</span>, <span class="bu">len</span>(test))</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;look_back &#39;</span>, look_back)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Training dataset length  594
Testing dataset length  149
look_back  30
</code></pre>
</div>
</div>
<section id="build-the-model-and-train" class="cell markdown"
id="QwHn0GekHD-4">
<h1>Build the model and train</h1>
</section>
<div class="cell code" data-execution_count="271"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="DwtbfoXhem6Q" data-outputId="7ebe2ecc-f5bf-41f2-dbb2-9a691f1f4dbf">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>git clone https:<span class="op">//</span>github.com<span class="op">/</span>lessw2020<span class="op">/</span>Ranger<span class="op">-</span>Deep<span class="op">-</span>Learning<span class="op">-</span>Optimizer.git</span></code></pre></div>
<div class="output stream stdout">
<pre><code>fatal: destination path &#39;Ranger-Deep-Learning-Optimizer&#39; already exists and is not an empty directory.
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="272" id="irPD63Tje2zt">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>sys.path.append(<span class="st">&quot;/content/Ranger-Deep-Learning-Optimizer&quot;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ranger <span class="im">import</span> Ranger</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="272" id="Ueb9JpVBe3hk">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="273"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="bmJ-TprZHD-5" data-outputId="12168af9-e5cd-4dae-98fc-dfd6e15d2414"
data-scrolled="true">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create and fit the LSTM network</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>model.add(LSTM(lstm_layers, return_sequences<span class="op">=</span><span class="va">True</span>, input_shape<span class="op">=</span>(look_back,num_of_features)))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>model.add(GRU(lstm_layers))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>model.add(Dense(<span class="dv">1</span>))</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">&#39;mean_squared_error&#39;</span>, optimizer<span class="op">=</span><span class="st">&#39;adam&#39;</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>history<span class="op">=</span> model.fit(trainX, trainY,validation_split<span class="op">=</span><span class="fl">0.30</span>, epochs<span class="op">=</span>epochs, batch_size<span class="op">=</span>batch_size,shuffle<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/10
13/13 [==============================] - 5s 105ms/step - loss: 0.1218 - val_loss: 0.0533
Epoch 2/10
13/13 [==============================] - 0s 31ms/step - loss: 0.0247 - val_loss: 0.0053
Epoch 3/10
13/13 [==============================] - 0s 34ms/step - loss: 0.0116 - val_loss: 0.0097
Epoch 4/10
13/13 [==============================] - 0s 33ms/step - loss: 0.0071 - val_loss: 0.0017
Epoch 5/10
13/13 [==============================] - 0s 29ms/step - loss: 0.0051 - val_loss: 0.0017
Epoch 6/10
13/13 [==============================] - 0s 32ms/step - loss: 0.0046 - val_loss: 0.0017
Epoch 7/10
13/13 [==============================] - 0s 34ms/step - loss: 0.0039 - val_loss: 0.0022
Epoch 8/10
13/13 [==============================] - 0s 33ms/step - loss: 0.0031 - val_loss: 0.0027
Epoch 9/10
13/13 [==============================] - 0s 33ms/step - loss: 0.0030 - val_loss: 0.0026
Epoch 10/10
13/13 [==============================] - 1s 41ms/step - loss: 0.0036 - val_loss: 0.0026
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="274"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:472}"
id="Bvfp64zgHD-5" data-outputId="ef59e117-2f0a-4794-f92c-2fca9db52c03"
data-scrolled="true">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot training</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">&#39;loss&#39;</span>])</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">&#39;val_loss&#39;</span>])</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Model loss&#39;</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Loss&#39;</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Epoch&#39;</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">&#39;training&#39;</span>, <span class="st">&#39;validation&#39;</span>], loc<span class="op">=</span><span class="st">&#39;upper right&#39;</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_1e41e510bcae412dafa696c0ab5d6b66/18702cb4927615faaba5789a663e41a4718bcc55.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="275"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ljzaMyfDHD-5" data-outputId="f9f09d87-1ad9-4952-caa8-6ad56288ecfa">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>trainPredict <span class="op">=</span> model.predict(trainX)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>testPredict <span class="op">=</span> model.predict(testX)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get something which has as many features as dataset</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>trainPredict_extended <span class="op">=</span> np.zeros((<span class="bu">len</span>(trainPredict),num_of_features))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Put the predictions there</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>trainPredict_extended[:,pred_col] <span class="op">=</span> trainPredict[:,<span class="dv">0</span>]</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Inverse transform it and select the 3rd column.</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>trainPredict <span class="op">=</span> scaler.inverse_transform(trainPredict_extended) [:,pred_col]</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Get something which has as many features as dataset</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>testPredict_extended <span class="op">=</span> np.zeros((<span class="bu">len</span>(testPredict),num_of_features))</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Put the predictions there</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>testPredict_extended[:,pred_col] <span class="op">=</span> testPredict[:,<span class="dv">0</span>]</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Inverse transform it and select the pred_col column.</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>testPredict <span class="op">=</span> scaler.inverse_transform(testPredict_extended)[:,pred_col]</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>trainY_extended <span class="op">=</span> np.zeros((<span class="bu">len</span>(trainY),num_of_features))</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>trainY_extended[:,pred_col]<span class="op">=</span>trainY</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>trainY <span class="op">=</span> scaler.inverse_transform(trainY_extended)[:,pred_col]</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>testY_extended <span class="op">=</span> np.zeros((<span class="bu">len</span>(testY),num_of_features))</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>testY_extended[:,pred_col]<span class="op">=</span>testY</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>testY <span class="op">=</span> scaler.inverse_transform(testY_extended)[:,pred_col]</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate root mean squared error</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>trainScore_RMSE <span class="op">=</span> math.sqrt(mean_squared_error(trainY, trainPredict))</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>testScore_RMSE <span class="op">=</span> math.sqrt(mean_squared_error(testY, testPredict))</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate absolute mean error</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>trainScore_MAE <span class="op">=</span> np.<span class="bu">sum</span>(np.absolute(trainY <span class="op">-</span> trainPredict))<span class="op">/</span><span class="bu">len</span>(trainY)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>testScore_MAE <span class="op">=</span> np.<span class="bu">sum</span>(np.absolute(testY <span class="op">-</span> testPredict))<span class="op">/</span><span class="bu">len</span>(testY)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>18/18 [==============================] - 1s 7ms/step
4/4 [==============================] - 0s 8ms/step
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="276"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:662}"
id="ClfGoKOLHD-6" data-outputId="f2eae353-3ff0-427b-ccb5-538a021a6fda">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># shift train predictions for plotting</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>trainPredictPlot <span class="op">=</span> np.empty_like(dataset)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>trainPredictPlot[:, :] <span class="op">=</span> np.nan</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>trainPredictPlot[look_back:<span class="bu">len</span>(trainPredict)<span class="op">+</span>look_back, pred_col] <span class="op">=</span> trainPredict</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># shift test predictions for plotting</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>testPredictPlot <span class="op">=</span> np.empty_like(dataset)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>testPredictPlot[:, :] <span class="op">=</span> np.nan</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>testPredictPlot[<span class="bu">len</span>(trainPredict)<span class="op">+</span>(look_back<span class="op">*</span><span class="dv">2</span>)<span class="op">+</span><span class="dv">1</span>:<span class="bu">len</span>(dataset)<span class="op">-</span><span class="dv">1</span>, pred_col] <span class="op">=</span> testPredict</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># contruct pandas dataframe for plotting</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>time_df <span class="op">=</span> pd.DataFrame(org_df.index)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>time_df[<span class="st">&#39;Actual&#39;</span>] <span class="op">=</span> scaler.inverse_transform(dataset)[:,pred_col]</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame(trainPredictPlot[:,pred_col],columns<span class="op">=</span>[<span class="st">&#39;Train&#39;</span>])</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame(testPredictPlot[:,pred_col],columns<span class="op">=</span>[<span class="st">&#39;Test&#39;</span>])</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>time_df2 <span class="op">=</span> pd.concat([time_df, df1, df2], axis<span class="op">=</span><span class="dv">1</span>, sort<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>time_df2.set_index(<span class="st">&#39;Date&#39;</span>,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the output</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">7</span>))</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>time_df2.plot(ax<span class="op">=</span>ax,rot<span class="op">=</span><span class="dv">90</span>,alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Date&#39;</span>)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Bitcoin Value&#39;</span>)</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Bitcoin Price Prediction&#39;</span>)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>plt.savefig(expr_name <span class="op">+</span> <span class="st">&#39;.png&#39;</span>,bbox_inches <span class="op">=</span> <span class="st">&quot;tight&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_1e41e510bcae412dafa696c0ab5d6b66/5720c08f9878b8abea1d9b205a664e1ffa0cedd3.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="277"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="u81bf1b7HD-6" data-outputId="9924807b-ffe6-420f-feb6-bdc16a05fde8">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;-&#39;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Experiment name:&#39;</span>, expr_name)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;-&#39;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;look_back days:&#39;</span>, look_back<span class="op">/</span><span class="dv">24</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;lstm_layers:&#39;</span>, lstm_layers)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;epochs:&#39;</span>, epochs)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;batch_size:&#39;</span>, batch_size)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;dataset features&#39;</span>, <span class="bu">list</span>(org_df.columns))</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;-&#39;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Train Score: </span><span class="sc">%.2f</span><span class="st"> RMSE&#39;</span> <span class="op">%</span> (trainScore_RMSE))</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Test Score: </span><span class="sc">%.2f</span><span class="st"> RMSE&#39;</span> <span class="op">%</span> (testScore_RMSE))</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;-&#39;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Train Score: </span><span class="sc">%.2f</span><span class="st"> MAE&#39;</span> <span class="op">%</span> (trainScore_MAE))</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Test Score: </span><span class="sc">%.2f</span><span class="st"> MAE&#39;</span> <span class="op">%</span> (testScore_MAE))</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;-&#39;</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Model summary:&#39;</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>--------------------------------------------------
Experiment name: expr_16
--------------------------------------------------
look_back days: 1.25
lstm_layers: 32
epochs: 10
batch_size: 32
dataset features [&#39;SP500&#39;, &#39;DOW30&#39;, &#39;EuroStoxx50&#39;, &#39;NASDAQ&#39;, &#39;CrudeOil&#39;, &#39;SSE&#39;, &#39;Gold&#39;, &#39;VIX&#39;, &#39;Nikkei225&#39;, &#39;FTSE100&#39;, &#39;EURUSD&#39;, &#39;CNYUSD&#39;, &#39;GBPUSD&#39;, &#39;JPYUSD&#39;, &#39;CHFUSD&#39;, &#39;BTC&#39;, &#39;zero_balance_addresses_all_time&#39;, &#39;unique_addresses_all_time&#39;, &#39;new_addresses&#39;, &#39;active_addresses&#39;, &#39;transaction_count&#39;, &#39;transaction_count_all_time&#39;, &#39;large_transaction_count&#39;, &#39;average_transaction_value&#39;, &#39;block_height&#39;, &#39;hashrate&#39;, &#39;difficulty&#39;, &#39;block_time&#39;, &#39;block_size&#39;, &#39;current_supply&#39;]
--------------------------------------------------
Train Score: 2091.16 RMSE
Test Score: 3859.64 RMSE
--------------------------------------------------
Train Score: 1680.31 MAE
Test Score: 3344.20 MAE
--------------------------------------------------
Model summary:
Model: &quot;sequential_24&quot;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm_24 (LSTM)              (None, 30, 32)            8064      
                                                                 
 gru_24 (GRU)                (None, 32)                6336      
                                                                 
 dense_24 (Dense)            (None, 1)                 33        
                                                                 
=================================================================
Total params: 14433 (56.38 KB)
Trainable params: 14433 (56.38 KB)
Non-trainable params: 0 (0.00 Byte)
_________________________________________________________________
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="277" id="CNoDOHSWHD-6">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
